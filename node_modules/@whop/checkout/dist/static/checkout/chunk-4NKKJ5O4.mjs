function e(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function t(e){if(Array.isArray(e))return e}function r(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function n(e,t,r,n,o,a,i){try{var s=e[a](i);var u=s.value}catch(e){r(e);return}if(s.done){t(u)}else{Promise.resolve(u).then(n,o)}}function o(e){return function(){var t=this,r=arguments;return new Promise(function(o,a){var i=e.apply(t,r);function s(e){n(i,o,a,s,u,"next",e)}function u(e){n(i,o,a,s,u,"throw",e)}s(undefined)})}}function a(e,t,r){t=d(t);return g(e,q()?Reflect.construct(t,r||[],d(e).constructor):t.apply(e,r))}function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t,r){if(q()){s=Reflect.construct}else{s=function e(e,t,r){var n=[null];n.push.apply(n,t);var o=Function.bind.apply(e,n);var a=new o;if(r)_(a,r.prototype);return a}}return s.apply(null,arguments)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function l(e,t,r){if(t)u(e.prototype,t);if(r)u(e,r);return e}function c(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function d(e){d=Object.setPrototypeOf?Object.getPrototypeOf:function e(e){return e.__proto__||Object.getPrototypeOf(e)};return d(e)}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_(e,t)}function v(e,t){if(t!=null&&typeof Symbol!=="undefined"&&t[Symbol.hasInstance]){return!!t[Symbol.hasInstance](e)}else{return e instanceof t}}function h(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function p(e,t){var r=e==null?null:typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r==null)return;var n=[];var o=true;var a=false;var i,s;try{for(r=r.call(e);!(o=(i=r.next()).done);o=true){n.push(i.value);if(t&&n.length===t)break}}catch(e){a=true;s=e}finally{try{if(!o&&r["return"]!=null)r["return"]()}finally{if(a)throw s}}return n}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};var n=Object.keys(r);if(typeof Object.getOwnPropertySymbols==="function"){n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))}n.forEach(function(t){c(e,t,r[t])})}return e}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(t){n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})}r.push.apply(r,n)}return r}function w(e,t){t=t!=null?t:{};if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{b(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function g(e,t){if(t&&(O(t)==="object"||typeof t==="function")){return t}return r(e)}function _(e,t){_=Object.setPrototypeOf||function e(e,t){e.__proto__=t;return e};return _(e,t)}function P(e,r){return t(e)||p(e,r)||k(e,r)||m()}function O(e){"@swc/helpers - typeof";return e&&typeof Symbol!=="undefined"&&e.constructor===Symbol?"symbol":typeof e}function k(t,r){if(!t)return;if(typeof t==="string")return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor)n=t.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}function E(e){var t=typeof Map==="function"?new Map:undefined;E=function e(e){if(e===null||!h(e))return e;if(typeof e!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof t!=="undefined"){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return s(e,arguments,d(this).constructor)}r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:false,writable:true,configurable:true}});return _(r,e)};return E(e)}function q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(q=function(){return!!e})()}function j(e,t){var r,n,o,a={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i=Object.create((typeof Iterator==="function"?Iterator:Object).prototype);return i.next=s(0),i["throw"]=s(1),i["return"]=s(2),typeof Symbol==="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return u([e,t])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(i&&(i=0,s[0]&&(a=0)),a)try{if(r=1,n&&(o=s[0]&2?n["return"]:s[0]?n["throw"]||((o=n["return"])&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;if(n=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:a.label++;return{value:s[1],done:false};case 5:a.label++;n=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(o=a.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){a=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(s[0]===6&&a.label<o[1]){a.label=o[1];o=s;break}if(o&&a.label<o[2]){a.label=o[2];a.ops.push(s);break}if(o[2])a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];n=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}var R=Object.defineProperty;var S=function(e,t,r){return t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r};var U=function(e,t,r){return S(e,(typeof t==="undefined"?"undefined":O(t))!="symbol"?t+"":t,r)};var W=/*#__PURE__*/function(e){"use strict";f(t,e);function t(){i(this,t);var e;e=a(this,t,arguments);U(e,"type","WhopCheckoutError");return e}return t}(E(Error));var A=/*#__PURE__*/function(e){"use strict";f(t,e);function t(e){i(this,t);var r;r=a(this,t,[e!==null&&e!==void 0?e:"Timeout waiting for embed response"]);U(r,"name","WhopCheckoutRpcTimeoutError");return r}return t}(W);var C=/*#__PURE__*/function(e){"use strict";f(t,e);function t(e){i(this,t);var r;r=a(this,t,[e!==null&&e!==void 0?e:"Aborted waiting for embed response"]);U(r,"name","WhopCheckoutRpcAbortedError");return r}return t}(W);var L=/*#__PURE__*/function(e){"use strict";f(t,e);function t(){i(this,t);var e;e=a(this,t,arguments);U(e,"name","WhopCheckoutSetEmailError");return e}return t}(W);var x=/*#__PURE__*/function(e){"use strict";f(t,e);function t(){i(this,t);var e;e=a(this,t,arguments);U(e,"name","WhopCheckoutSetAddressError");return e}return t}(W);var D=/*#__PURE__*/function(e){"use strict";f(t,e);function t(){i(this,t);var e;e=a(this,t,arguments);U(e,"name","WhopCheckoutGetAddressError");return e}return t}(W);var M=["resize","center","complete","state","get-email-result","set-email-result","set-address-result","get-address-result","address-validation-error","payment-request-merchant-validation-result","payment-request-update-request","payment-request-create-request","payment-request-event-result"];function I(e){return O(e.data)=="object"&&e.data!==null&&"event"in e.data&&M.includes(e.data.event)}function T(e,t){return I(e)&&e.data.event===t}var N=[];function F(e){return N[e]||(N[e]=(e+256).toString(16).slice(1))}function B(){var e=new Uint8Array(16);if((typeof crypto==="undefined"?"undefined":O(crypto))<"u"&&typeof crypto.getRandomValues=="function")crypto.getRandomValues(e);else for(var t=0;t<16;t++)e[t]=Math.random()*256|0;return e[6]=e[6]&15|64,e[8]=e[8]&63|128,F(e[0])+F(e[1])+F(e[2])+F(e[3])+"-"+F(e[4])+F(e[5])+"-"+F(e[6])+F(e[7])+"-"+F(e[8])+F(e[9])+"-"+F(e[10])+F(e[11])+F(e[12])+F(e[13])+F(e[14])+F(e[15])}function G(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:2e3,a=arguments.length>5?arguments[5]:void 0;var i;var s=new URL(e.src).origin,u=B();return(i=e.contentWindow)===null||i===void 0?void 0:i.postMessage(w(y({},t),{__scope:"whop-embedded-checkout",event_id:u}),s),new Promise(function(t,i){if(a===null||a===void 0?void 0:a.aborted){i(new Error("Aborted"));return}var s=function(){l&&clearTimeout(l),window.removeEventListener("message",d),a===null||a===void 0?void 0:a.removeEventListener("abort",c)},l=o!==null?setTimeout(function(){i(new A),s()},o):null,c=function(){i(new C),s()};a===null||a===void 0?void 0:a.addEventListener("abort",c,{once:!0});var d=function(o){if(o.source===e.contentWindow&&T(o,r)&&o.data.event===r&&o.data.event_id===u){s();try{t(n(o.data))}catch(e){i(e)}}};window.addEventListener("message",d)})}var J=/*#__PURE__*/function(){"use strict";function e(t,r,n,o){i(this,e);this.iframe=t;this.methodData=r;this.details=n;this.options=o;U(this,"id",B());U(this,"abortController")}l(e,[{key:"active",get:function t(){var t;return(t=e.activeRequests.get(this.iframe))!==null&&t!==void 0?t:!1}},{key:"updateMethodData",value:function e(e){this.methodData=e}},{key:"updateDetails",value:function e(e){this.details=e}},{key:"updateOptions",value:function e(e){this.options=e}},{key:"getResult",value:function e(){return o(function(){var e,t,r,n,a,i,s,u,l,c;return j(this,function(d){switch(d.label){case 0:e=this;t=new AbortController;this.abortController=t;r=new PaymentRequest(this.methodData,this.details,this.options);r.onmerchantvalidation=function(n){return o(function(){var e,o;return j(this,function(a){switch(a.label){case 0:e={event:"payment-request-merchant-validation-request",validationURL:n.validationURL,methodName:n.methodName,id:this.id};return[4,G(this.iframe,e,"payment-request-merchant-validation-result",function(e){return e},null,t.signal).catch(function(){return null})];case 1:o=a.sent();(o===null||o===void 0?void 0:o.ok)?n.complete(o.merchantSession):r.abort();return[2]}})}).call(e)},r.onshippingaddresschange=function(e){e.updateWith({})},r.onpaymentmethodchange=function(r){return o(function(){var e,n;return j(this,function(o){switch(o.label){case 0:e={event:"payment-request-payment-method-change-request",id:this.id,data:r.methodDetails};return[4,G(this.iframe,e,"payment-request-event-result",function(e){return e},null,t.signal).catch(function(){return null})];case 1:n=o.sent();(n===null||n===void 0?void 0:n.ok)?r.updateWith(n.details):r.updateWith({});return[2]}})}).call(e)};n=r;d.label=1;case 1:d.trys.push([1,,6,7]);u=new Promise(function(e,r){var n=function(){r(new Error("Aborted"))};t.signal.addEventListener("abort",n,{once:!0}),a=function(){t.signal.removeEventListener("abort",n)}});return[4,Promise.race([r.show().then(function(e){return n=null,e}),u])];case 2:l=d.sent(),c=this.methodData.find(function(e){return e.supportedMethods===l.methodName});if(!!c)return[3,4];return[4,l.complete("fail")];case 3:throw d.sent(),new Error("PaymentRequest failed to complete because of missing method data");case 4:return[4,l.complete("success")];case 5:return[2,(d.sent(),{method:l.methodName,response:{payerEmail:l.payerEmail,details:JSON.parse(JSON.stringify(l.details))},options:this.options,methodData:{applePayMerchantIdentifier:c===null||c===void 0?void 0:(i=c.data)===null||i===void 0?void 0:i.merchantIdentifier,requestShipping:c===null||c===void 0?void 0:(s=c.data)===null||s===void 0?void 0:s.requiredShippingContactFields}})];case 6:n===null||n===void 0?void 0:n.abort(),a===null||a===void 0?void 0:a(),this.abortController=void 0;return[7];case 7:return[2]}})}).call(this)}},{key:"abort",value:function e(){var e;(e=this.abortController)===null||e===void 0?void 0:e.abort()}}],[{key:"get",value:function t(t){var r;return(r=e.requests.get(t))!==null&&r!==void 0?r:null}},{key:"create",value:function t(t,r,n,o){var a=new e(t,r,n,o);return e.requests.set(t,a),a}},{key:"remove",value:function t(t){var r;(r=e.requests.get(t))===null||r===void 0?void 0:r.abort(),e.requests.delete(t),e.activeRequests.delete(t)}},{key:"setActive",value:function t(t,r){e.activeRequests.set(t,r)}}]);return e}();U(J,"requests",new WeakMap),U(J,"activeRequests",new WeakMap);var V=J;var z=1;function $(e,t){function r(r){if(r.source===e.contentWindow&&I(r)){switch(r.data.event){case"payment-request-create-request":{try{var n;var o=V.create(e,r.data.method_data,r.data.details,r.data.options),a={__scope:"whop-embedded-checkout",event:"payment-request-create-result",event_id:r.data.event_id,ok:!0,id:o.id},i=new URL(e.src).origin;(n=e.contentWindow)===null||n===void 0?void 0:n.postMessage(a,i)}catch(t){var s;var u={__scope:"whop-embedded-checkout",event:"payment-request-create-result",event_id:r.data.event_id,ok:!1,error:v(t,Error)?t.message:"Unknown error"},l=new URL(e.src).origin;(s=e.contentWindow)===null||s===void 0?void 0:s.postMessage(u,l)}return}case"payment-request-update-request":{"active"in r.data&&typeof r.data.active=="boolean"&&V.setActive(e,r.data.active);try{var c;var d=V.get(e);if(!d)throw new Error("Payment request not found");"method_data"in r.data&&r.data.method_data&&d.updateMethodData(r.data.method_data),"details"in r.data&&r.data.details&&d.updateDetails(r.data.details),"options"in r.data&&r.data.options&&d.updateOptions(r.data.options);var f={__scope:"whop-embedded-checkout",event:"payment-request-update-result",event_id:r.data.event_id,ok:!0},h=new URL(e.src).origin;(c=e.contentWindow)===null||c===void 0?void 0:c.postMessage(f,h)}catch(t){var p;var m={__scope:"whop-embedded-checkout",event:"payment-request-update-result",event_id:r.data.event_id,ok:!1,error:v(t,Error)?t.message:"Unknown error"},y=new URL(e.src).origin;(p=e.contentWindow)===null||p===void 0?void 0:p.postMessage(m,y)}return}}t(r.data)}}return window.addEventListener("message",r),function(){window.removeEventListener("message",r)}}function H(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2e3;return o(function(){return j(this,function(n){return[2,G(e,{event:"set-email",email:t},"set-email-result",function(e){if(!e.ok)throw new L(e.error)},r)]})})()}function K(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2e3;return o(function(){return j(this,function(r){return[2,G(e,{event:"get-email"},"get-email-result",function(e){return e.email},t)]})})()}function Q(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2e3;return o(function(){return j(this,function(n){return[2,G(e,{event:"set-address",address:t},"set-address-result",function(e){if(!e.ok)throw new x(e.error)},r)]})})()}function X(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2e3;return o(function(){return j(this,function(r){return[2,G(e,{event:"get-address"},"get-address-result",function(e){if(!e.ok)throw new D(e.error);return{address:e.address,isComplete:e.is_complete}},t)]})})()}function Y(e,t){return o(function(){var t,r,n,o,a;return j(this,function(i){switch(i.label){case 0:r={__scope:"whop-embedded-checkout",event:"submit",event_id:B()},n=V.get(e);if(!(n===null||n===void 0?void 0:n.active))return[3,2];return[4,n.getResult()];case 1:o=i.sent();r.payment_request_result=o;i.label=2;case 2:a=new URL(e.src).origin;(t=e.contentWindow)===null||t===void 0?void 0:t.postMessage(r,a);return[2]}})})()}function Z(e){if(e==="off_session")return"off_session"}function ee(e,t,r,n,o,a,i,s,u,l,c,d,f,v,h,p,m){var y,b,w,g,_,O,k;var E=new URL("/embedded/checkout/".concat(e,"/"),n!==null&&n!==void 0?n:"https://whop.com/");E.searchParams.set("h",window.location.origin),E.searchParams.set("v",z.toString());try{var q=window;for(;q.parent!==q;)q=q.parent;var j=q.location.hostname;q.location.protocol==="https:"&&j&&E.searchParams.set("t",j)}catch(e){}if(t&&E.searchParams.set("theme",t),r&&E.searchParams.set("session",r),o&&E.searchParams.set("hide_price","true"),a&&E.searchParams.set("skip_redirect","true"),c&&E.searchParams.set("hide_submit_button","true"),d&&E.searchParams.set("hide_tos","true"),f&&E.searchParams.set("email.hidden","1"),v&&E.searchParams.set("email.disabled","1"),h&&E.searchParams.set("address.hidden","1"),p&&E.searchParams.set("a",p),m&&E.searchParams.set("setup_future_usage",m),i){var R=true,S=false,U=undefined,W=true,A=false,C=undefined;try{for(var L=Object.entries(i).sort(function(e,t){return e[0].localeCompare(t[0])})[Symbol.iterator](),x;!(W=(x=L.next()).done);W=true){var D=P(x.value,2),M=D[0],I=D[1];if(M.startsWith("utm_"))if(Array.isArray(I))try{for(var T=I[Symbol.iterator](),N;!(R=(N=T.next()).done);R=true){var F=N.value;E.searchParams.append(M,F)}}catch(e){S=true;U=e}finally{try{if(!R&&T.return!=null){T.return()}}finally{if(S){throw U}}}else E.searchParams.set(M,I)}}catch(e){A=true;C=e}finally{try{if(!W&&L.return!=null){L.return()}}finally{if(A){throw C}}}}if(s){var B=true,G=false,J=undefined,V=true,$=false,H=undefined;try{for(var K=Object.entries(s)[Symbol.iterator](),Q;!(V=(Q=K.next()).done);V=true){var X=P(Q.value,2),Y=X[0],Z=X[1];if(Z)try{for(var ee=Object.entries(Z)[Symbol.iterator](),et;!(B=(et=ee.next()).done);B=true){var er=P(et.value,2),en=er[0],eo=er[1];E.searchParams.set("style.".concat(Y,".").concat(en),eo.toString())}}catch(e){G=true;J=e}finally{try{if(!B&&ee.return!=null){ee.return()}}finally{if(G){throw J}}}}}catch(e){$=true;H=e}finally{try{if(!V&&K.return!=null){K.return()}}finally{if($){throw H}}}}var ea=true,ei=false,es=undefined;if((u===null||u===void 0?void 0:u.email)&&E.searchParams.set("email",u.email),(u===null||u===void 0?void 0:(y=u.address)===null||y===void 0?void 0:y.name)&&E.searchParams.set("name",u.address.name),(u===null||u===void 0?void 0:(b=u.address)===null||b===void 0?void 0:b.line1)&&E.searchParams.set("address.line1",u.address.line1),(u===null||u===void 0?void 0:(w=u.address)===null||w===void 0?void 0:w.line2)&&E.searchParams.set("address.line2",u.address.line2),(u===null||u===void 0?void 0:(g=u.address)===null||g===void 0?void 0:g.city)&&E.searchParams.set("address.city",u.address.city),(u===null||u===void 0?void 0:(_=u.address)===null||_===void 0?void 0:_.country)&&E.searchParams.set("address.country",u.address.country),(u===null||u===void 0?void 0:(O=u.address)===null||O===void 0?void 0:O.state)&&E.searchParams.set("address.state",u.address.state),(u===null||u===void 0?void 0:(k=u.address)===null||k===void 0?void 0:k.postalCode)&&E.searchParams.set("address.postal_code",u.address.postalCode),l)try{for(var eu=Object.entries(l)[Symbol.iterator](),el;!(ea=(el=eu.next()).done);ea=true){var ec=P(el.value,2),ed=ec[0],ef=ec[1];ef&&E.searchParams.set("theme.".concat(ed),typeof ef=="boolean"?"1":ef)}}catch(e){ei=true;es=e}finally{try{if(!ea&&eu.return!=null){eu.return()}}finally{if(ei){throw es}}}return E.toString()}var et=["allow-forms","allow-modals","allow-orientation-lock","allow-pointer-lock","allow-popups","allow-presentation","allow-same-origin","allow-scripts","allow-top-navigation","allow-top-navigation-by-user-activation","allow-downloads"],er="document-domain; execution-while-not-rendered; execution-while-out-of-viewport; payment; paymentRequest; sync-script;";export{I as a,V as b,$ as c,H as d,K as e,Q as f,X as g,Y as h,Z as i,ee as j,et as k,er as l};